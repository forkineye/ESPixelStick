<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title id="title"></title>

    <!-- for local development
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" href="css/treejs.css" id="treejs_styles">
    <link rel="stylesheet" href="css/dropzone.css" id="dropzone_styles">
    -->

    <link rel="stylesheet" type="text/css" href="esps.css">

</head>

    <body>
        <nav class="navbar navbar-inverse navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">ESPixelStick</a>
                </div>
                <div id="navbar" class="collapse navbar-collapse">
                    <ul class="nav navbar-nav" id="navbar-ul">
                        <li class="active"><a href="#home">Home</a></li>
                        <li><a href="#wifi">WiFi Setup</a></li>
                        <li><a href="#config">Device Setup</a></li>
                        <li><a href="#diag">Diagnostics</a></li>
                        <li id="li-filemanagement" class="hidden"><a href="#filemanagement">File Management</a></li>
                    </ul>
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="#admin">Admin</a></li>
                    </ul>
                </div>
            </div>
        </nav>

        <div class="container">
            <!-- Home / Status page -->
            <div id="home" class="collapse in mdiv anchor">
                <div class="row">
                    <div class="col-sm-6">
                        <fieldset>
                            <legend class="esps-legend">Network Status</legend>
                            <table class="esps-table">
                                <tr><td width="33%">SSID</td><td><span id="x_ssid"></span></td></tr>
                                <tr><td width="33%">Hostname</td><td><span id="x_hostname"></span></td></tr>
                                <tr><td width="33%">IP</td><td><span id="x_ip"></span></td></tr>
                                <tr><td width="33%">SubNet</td><td><span id="x_subnet"></span></td></tr>
                                <tr><td width="33%">MAC</td><td><span id="x_mac"></span></td></tr>
                                <tr><td width="33%">RSSI</td><td><span id="x_rssi"></span>dBm / <span id="x_quality"></span>%</td></tr>
                                <tr><td width="33%">Free Heap</td><td><span id="x_freeheap"></span></td></tr>
                                <tr><td width="33%">Up Time</td><td><span id="x_uptime"></span></td></tr>
                            </table>
                        </fieldset>
                    </div>

                    <div class="col-sm-6 hidden" id="E131Status">
                        <fieldset>
                            <legend class="esps-legend">E1.31 Status</legend>
                            <table class="esps-table">
                                <tr><td width="33%">Universe Range</td><td><span id="uni_first"></span> to <span id="uni_last"></span></td></tr>
                                <tr><td width="33%">Channels / Universe</td><td><span id="chanlim"></span></td></tr>
                                <tr><td width="33%">Total Packets</td><td><span id="pkts"></span></td></tr>
                                <tr><td width="33%">Packet Errors</td><td><span id="perr"></span></td></tr>
                                <tr><td width="33%">Source IP</td><td><span id="clientip"></span></td></tr>
                            </table>
                        </fieldset>
                    </div>
                    <div class="col-sm-6 hidden" id="ArtnetStatus">
                        <fieldset>
                            <legend class="esps-legend">Artnet Status</legend>
                            <table class="esps-table">
                                <tr><td width="33%">Universe Range</td><td><span id="an_uni_first"></span> to <span id="an_uni_last"></span></td></tr>
                                <tr><td width="33%">Channels / Universe</td><td><span id="an_chanlim"></span></td></tr>
                                <tr><td width="33%">Total Packets</td><td><span id="an_pkts"></span></td></tr>
                                <tr><td width="33%">Packet Errors</td><td><span id="an_perr"></span></td></tr>
                                <tr><td width="33%">Source IP</td><td><span id="an_clientip"></span></td></tr>
                            </table>
                        </fieldset>
                    </div>
                    <div class="col-sm-6 hidden" id="ddpStatus">
                        <fieldset>
                            <legend class="esps-legend">DDP Status</legend>
                            <table class="esps-table">
                                <tr><td width="33%">Total Packets: </td><td><span id="ddppacketsreceived"></span></td></tr>
                                <tr><td width="33%">Total Bytes: </td><td><span id="ddpbytesreceived"></span></td></tr>
                                <tr><td width="33%">Errors: </td><td><span id="ddperrors"></span></td></tr>
                            </table>
                        </fieldset>
                    </div>
                    <div class="col-sm-6 hidden" id="FPPRemoteStatus">
                        <fieldset>
                            <legend class="esps-legend">FPP Remote Status</legend>
                            <table class="esps-table">
                                <tr><td width="50%">Total Sync Packets: </td><td><span id="fppsyncreceived"></span></td></tr>
                                <tr><td width="50%">Sync Adjustments: </td><td><span id="fppsyncadjustments"></span></td></tr>
                                <tr><td width="50%">Master IP: </td><td><span id="fppremoteip"></span></td></tr>
                                <tr><td width="50%">Filename: </td><td><span id="fppremoteFilePlayerFilename"></span></td></tr>
                                <tr><td width="50%">Time Elapsed: </td><td><span id="fppremoteFilePlayerTimeElapsed"></span></td></tr>
                                <tr><td width="50%">Time Remaining: </td><td><span id="fppremoteFilePlayerTimeRemaining"></span></td></tr>
                                <tr><td width="50%">Frame Time Adjustment: </td><td><span id="fppremoteFilePlayerTimeOffset"></span></td></tr>
                            </table>
                        </fieldset>
                    </div>
                    <div class="col-sm-6 hidden" id="LocalPlayListPlayerStatus">
                        <fieldset>
                            <legend class="esps-legend">Local Play List Status</legend>
                            <table class="esps-table">
                                <tr><td width="50%">File Name: </td><td><span id="localPlayListName"></span></td></tr>
                                <tr><td width="50%">Entry: </td><td><span id="localPlayListEntry"></span></td></tr>
                                <tr><td width="50%">Count: </td><td><span id="localPlayListCount"></span></td></tr>
                                <tr><td width="50%">Remaining Repeat: </td><td><span id="localPlayListRepeat"></span></td></tr>
                            </table>
                        </fieldset>
                    </div>
                    <div class="col-sm-6 hidden" id="LocalFilePlayerStatus">
                        <fieldset>
                            <legend class="esps-legend">Local File Player Status</legend>
                            <table class="esps-table">
                                <tr><td width="50%">Filename: </td><td><span id="localFilePlayerFilename"></span></td></tr>
                                <tr><td width="50%">Time Elapsed: </td><td><span id="localFilePlayerTimeElapsed"></span></td></tr>
                                <tr><td width="50%">Time Remaining: </td><td><span id="localFilePlayerTimeRemaining"></span></td></tr>
                            </table>
                        </fieldset>
                    </div>
                    <div class="col-sm-6 hidden" id="LocalEffectPlayerStatus">
                        <fieldset>
                            <legend class="esps-legend">Local Effect Player Status</legend>
                            <table class="esps-table">
                                <tr><td width="50%">Name: </td><td><span id="localFilePlayerEffectName"></span></td></tr>
                                <tr><td width="50%">Time Remaining: </td><td><span id="localFilePlayerEffectTimeRemaining"></span></td></tr>
                            </table>
                        </fieldset>
                    </div>
                    <div class="col-sm-6 hidden" id="PausedPlayerStatus">
                        <fieldset>
                            <legend class="esps-legend">Paused Player Status</legend>
                            <table class="esps-table">
                                <tr><td width="50%">Time Remaining: </td><td><span id="PausedTimeRemaining"></span></td></tr>
                            </table>
                        </fieldset>
                    </div>
                </div>
            </div>

            <!-- Network Configuration -->
            <div id="wifi" class="mdiv hidden anchor">
                <form class="form-horizontal">
                    <fieldset id="network">
                        <legend class="esps-legend">Network Configuration</legend>
                        <div class="form-group" id="fg_ssid">
                            <label class="control-label col-sm-2" for="ssid">SSID</label>
                            <div class="col-sm-6">
                                <input type="text" class="form-control is-valid" id="ssid" maxlength="32" title="The SSID for your access point.">
                            </div>
                        </div>
                        <div class="form-group" id="fg_password">
                            <label class="control-label col-sm-2" for="passphrase">Password</label>
                            <div class="col-sm-6">
                                <input type="password" class="form-control is-valid" id="passphrase" maxlength="64" title="The password for your access point.">
                            </div>
                        </div>
                        <div class="form-group" id="fg_hostname">
                            <label class="control-label col-sm-2" for="hostname">Hostname</label>
                            <div class="col-sm-6">
                                <input type="text" class="form-control is-valid" id="hostname" required pattern="^[a-zA-Z][a-zA-Z\d-]{1,30}[a-zA-Z\d]$" title="Hostname for this device.">
                            </div>
                        </div>
                        <div class="form-group" id="fg_staTimeout">
                            <label class="control-label col-sm-2" for="sta_timeout">Client Timeout</label>
                            <div class="col-sm-2">
                                <input type="number" class="form-control is-valid" id="sta_timeout" step="1" min="15" max="60" value="0" title="When connecting as a client, this is the timeout in seconds.">
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-8">
                                <div class="checkbox"><label><input type="checkbox" id="dhcp" title="Usage of DHCP with static leases is recommended."> Use DHCP</label></div>
                            </div>
                        </div>
                        <div class="form-group dhcp has-feedback" id="fg_ip">
                            <label class="control-label col-sm-2 dhcp" for="ip">IP</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control is-valid dhcp" id="ip" name="ip" minlength="7" maxlength="15" required pattern='^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$' value="0.0.0.0" title="Static IP Address">
                            </div>
                        </div>
                        <div class="form-group dhcp has-feedback" id="fg_netmask">
                            <label class="control-label col-sm-2 dhcp" for="netmask">Netmask</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control is-valid dhcp" id="netmask" name="netmask" minlength="7" maxlength="15" required pattern='^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$' value="0.0.0.0" title="Static Netmask">
                            </div>
                        </div>
                        <div class="form-group dhcp has-feedback" id="fg_gateway">
                            <label class="control-label col-sm-2" for="gateway">Gateway</label>
                            <div class="col-sm-8">
                                <input type="text" class="form-control is-valid dhcp" id="gateway" name="gateway" minlength="7" maxlength="15" required pattern='^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$' value="0.0.0.0" title="Static Gateway">
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-8">
                                <div class="checkbox"><label><input type="checkbox" id="ap_fallback" title="Enabling this will cause your device to come up as an Access Point if your configured WiFi connection fails. Not recommended for live / production devices."> AP Fallback</label></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-8">
                                <div class="checkbox"><label><input type="checkbox" id="ap_reboot" title="Enabling this will cause your device to Reboot when all connections fail."> AP ReBoot</label></div>
                            </div>
                        </div>
                    </fieldset>
                    <div class="form-group">
                        <div class="col-sm-offset-2 col-sm-8">
                            <button id="btn_wifi" type="button" class="btn btn-primary">Save Changes</button>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Device Configuration -->
            <div id="config" class="mdiv hidden anchor">
                <form class="form-horizontal">
                    <fieldset id="device">
                        <legend class="esps-legend">Device Configuration</legend>
                        <div class="form-group">
                            <label class="control-label col-sm-2" for="id">Device ID</label>
                            <div class="col-sm-10"><input type="text" class="form-control" id="id" maxlength="64" title="Plain text ID to help identify your device."></div>
                        </div>
                        <div class="form-group has-feedback">
                            <label class="control-label col-sm-2 hidden AdvancedMode" for="miso_pin">SD MISO Pin</label>
                            <div class="col-sm-4">
                                <input type="number" class="form-control is-valid hidden AdvancedMode" id="miso_pin" step="1" min="1" max="24" value="0" required title="GPIO on which MISO will be received">
                            </div>
                            <label class="control-label col-sm-2 hidden AdvancedMode" for="mosi_pin">SD MOSI Pin</label>
                            <div class="col-sm-4">
                                <input type="number" class="form-control is-valid hidden AdvancedMode" id="mosi_pin" step="1" min="1" max="24" value="0" required title="GPIO on which MOSI will be sent">
                            </div>
                        </div>

                        <div class="form-group has-feedback">
                            <label class="control-label col-sm-2 hidden AdvancedMode" for="clock_pin">SD Clock Pin</label>
                            <div class="col-sm-4">
                                <input type="number" class="form-control is-valid hidden AdvancedMode" id="clock_pin" step="1" min="1" max="24" value="0" required title="GPIO on which CLOCK will be sent">
                            </div>
                            <label class="control-label col-sm-2 hidden AdvancedMode" for="cs_pin">SD Chip Select Pin</label>
                            <div class="col-sm-4">
                                <input type="number" class="form-control is-valid hidden AdvancedMode" id="cs_pin" step="1" min="1" max="24" value="0" required title="GPIO on which Chip Select will be sent">
                            </div>
                        </div>

                        <!-- Dynamic input / ouput config -->
                        <div class="form-group" id="fg_input"></div>
                        <div class="form-group" id="fg_output"></div>

                        <!-- Dynamic input / ouput config -->
                        <div id="fg_input_mode"></div>
                        <div id="fg_output_mode"></div>
                        <!--  Move elsewhere
                            <legend class="esps-legend">Input Effect Trigger Configuration</legend>
                            <div class="col-sm-10">
                                <div class="form-group has-feedback" id="ecb">
                                    <div class="checkbox col-sm-2">
                                        <label>
                                            <input type="checkbox" id="ecb_enable" title="Trigger Effects using a buton."> Enable
                                        </label>
                                    </div>

                                    <label class="control-label col-sm-2" for="ecb_gpioid">GPIO</label>
                                    <div class="col-sm-2">
                                        <input type="number" class="form-control is-valid" id="ecb_gpioid" name="ecb_gpioid" step="1" min="0" max="24" value="0" title="GPIO to monitor for effects trigger">
                                    </div>

                                    <label class="control-label col-sm-2" for="ecb_polarity">Polarity</label>
                                    <select name="ecb_polarity" id="ecb_polarity">
                                        <option value="ActiveLow">ActiveLow</option>
                                        <option value="ActiveHigh">ActiveHigh</option>
                                    </select>
                                </div>
                            </div>
    -->
                        <!-- Refresh Rate Display -->
                        <div class="form-group">
                            <label class="control-label col-sm-2" for="refresh">Refresh Rate</label>
                            <div class="col-sm-10"><p class="form-control-static" id="refresh"></p></div>
                        </div>
                    </fieldset>

                    <!-- Device Config Save -->
                    <div class="form-group">
                        <div class="col-sm-offset-2 col-sm-10">
                            <button type="button" id="DeviceConfigSave" class="btn btn-primary">Save Changes</button>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Diagnostics -->
            <div id="diag" class="mdiv hidden anchor">
                <form class="form-horizontal">
                    <fieldset>
                        <legend class="esps-legend">View Stream</legend>
                        <div class="form-group">
                            <label class="control-label col-sm-2">Display As</label>
                            <div class="col-sm-2">
                                <select class="form-control" id="viewStyle">
                                    <option value="rgb">RGB</option>
                                    <option value="rgbw">RGBW</option>
                                    <option value="channels">Channels</option>
                                </select>
                            </div>

                            <label class="control-label col-sm-2" for="v_columns">Columns</label>
                            <div class="col-sm-2 has-feedback">
                                <input type="number" class="form-control is-valid" id="v_columns" name="v_columns" step="1" min="1" max="100" value="20">
                            </div>

                        </div>
                        <div class="row">
                            <div class="col-sm-12"><canvas id="canvas" width="820" height="960"></canvas></div>
                        </div>
                    </fieldset>
                </form>
            </div>

            <!-- FIleManagement -->
            <div id="filemanagement" class="mdiv hidden anchor">
                <fieldset>
                    <legend class="esps-legend">File Management</legend>
                    <div>
                        <a id="FileDeleteButton" class="button">Remove Selected File(s)</a>
                    </div>
                    <div>
                        <fieldset>
                            <legend class="esps-legend">Files</legend>
                            <table class="esps-table">
                                <thead>
                                    <tr>
                                        <th width="10%">Selected</th>
                                        <th width="50%">File Name</th>
                                        <th width="30%">File Date</th>
                                        <th width="15%">File Size</th>
                                    </tr>
                                </thead>
                                <tbody id="FileManagementTable">
                                    <tr></tr>
                                </tbody>
                            </table>

                            <div id="fseqprogress_fg" class="form-group col-sm-10 hidden">
                                <label class="control-label col-sm-4" for="fseqprogressbytes">Bytes Sent:</label>
                                <p class="form-control-static" id="fseqprogressbytes"></p>
                                <label class="control-label col-sm-4" for="fseqprogressbytes">Transfer Rate:</label>
                                <p class="form-control-static" id="fseqprogressrate"></p>
                            </div>
                            <div id="filemanagementupload">
                                <p>Click to Upload a file with the file dialog or drag and drop a file into the dashed region</p>
                            </div>

                        </fieldset>
                    </div>
                </fieldset>
            </div>

            <!-- Administration -->
            <div id="admin" class="mdiv hidden anchor">
                <fieldset>
                    <legend class="esps-legend">Administration</legend>
                    <form class="form-horizontal" id="updatefw" action="/updatefw" method="post" enctype="multipart/form-data">
                        <div class="form-group">
                            <label class="control-label col-sm-3">FW Version</label>
                            <div class="col-sm-9"><p class="form-control-static" id="version"></p></div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-sm-3">Build Date</label>
                            <div class="col-sm-9"><p class="form-control-static" id="built"></p></div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-sm-3">Flash Size</label>
                            <div class="col-sm-9"><p class="form-control-static" id="realflashsize"></p></div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-sm-3">Flash Chip ID</label>
                            <div class="col-sm-9"><p class="form-control-static" id="flashchipid"></p></div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-3">
                                <button type="button" class="btn btn-primary" id="backupconfig">Backup Settings</button>
                            </div>
                            <div class="col-sm-3">
                                <label class="btn btn-primary btn-file">
                                    Update Firmware <input type="file" id="efu" name="file" accept=".efu" style="display: none;"><br /><progress class="hidden" id="EfuProgressBar" value="0" max="100"></progress>
                                </label>
                            </div>
                            <div class="col-sm-3">
                                <label class="btn btn-primary btn-file">
                                    Restore Settings <input type="file" id="restoreconfig" accept=".json" style="display: none;">
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-10">
                                <button type="button" class="btn btn-danger" id="adminReboot">Reboot</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-10">
                                <button type="button" class="btn btn-danger" id="adminFactoryReset">Factory Reset</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-10" id="d_AdvancedOptions">
                                <div class="checkbox"><label><input type="checkbox" id="AdvancedOptions" class="" name="t_AdvancedMode">Advanced Mode</label></div>
                            </div>
                        </div>
                    </form>
                </fieldset>
            </div>
        </div>

        <div id="snackbar">Configuration Saved</div>

        <!-- Reboot Modal -->
        <div id="reboot" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Restarting, Please Wait</h4>
                        <div class="bar"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Update Modal -->
        <div id="update" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Firmware Updating</h4>
                    </div>
                    <div class="modal-body">
                        <p>Firmware update in progress...</p>
                        <div class="bar"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- WebSockets Error Modal -->
        <div id="wserror" class="modal fade" tabindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">WebSocket connection lost, attempting to reconnect...</h4>
                        <div class="bar"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="container">
                <i><span id="device-id"></span></i>
            </div>
        </footer>

        <!--
        <script type="text/javascript" src="js/dropzone.js"></script>
        <script type="text/javascript" src="js/jquery-3.5.1.js"></script>
        <script type="text/javascript" src="js/bootstrap.js"></script>
        <script type="text/javascript" src="js/jqColorPicker.js"></script>
        <script type="text/javascript" src="script.js"></script>
        <script type="text/javascript" src="js/FileSaver.js"></script>
        -->

        <script type="text/javascript" src="esps.js"></script>

    </body>
</html>
